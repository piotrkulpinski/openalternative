---
import { Image } from "astro:assets"
import type { HTMLAttributes } from "astro/types"

type Props = HTMLAttributes<"div"> & {
  url: string | null
}

const { class: className, url, ...props } = Astro.props

if (!url) return

const faviconParams = new URLSearchParams({
  url,
  size: "64",
  client: "SOCIAL",
  type: "FAVICON",
  fallback_opts: "TYPE,SIZE,URL",
})

const faviconUrl = `https://t0.gstatic.com/faviconV2?${faviconParams.toString()}`
---

<div
  class:list={[
    "flex items-center justify-center p-1.5 size-11 rounded-md bg-white shadow-md shadow-gray-800/5 ring-1 ring-gray-900/5",
    className,
  ]}
  {...props}
>
  <Image
    src={faviconUrl}
    alt=""
    width={64}
    height={64}
    loading="eager"
    class="size-full rounded aspect-square"
  />
</div>
